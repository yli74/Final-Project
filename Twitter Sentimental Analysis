library(twitteR)
library(plyr)

#set up twitter APIs
consumer_key <- "yGfMZdr02SidVYVTiul5YdJIh"
consumer_secret <- "ZxTcNmfJQ2cxLlykvYbZFFn0upknNVkpmdxAiGRDCZwIFN8wkH"
token <- "3192371979-CPwxqkws80IXLReSe1yMYl9QWEzCSEIv37lnPlZ" 
token_secret <- "ZFeXPlFmA8hsDs6dCAeR4E909lIkfcSjUFGLQ3jGlmwo4" #Access token secret
setup_twitter_oauth(consumer_key, consumer_secret, token, token_secret)

#Get tweets about "House of Cards", due to the limitation, we'll set n=1500
netflix.tweets<- searchTwitter("House of Cards S1",n=1500)
tweet=netflix.tweets[[1]]
tweet$getScreenName()
tweet$getText()
netflix.text=laply(netflix.tweets,function(t)t$getText())
length(netflix.text)
head(netflix.text) 
write(netflix.text, "HouseofCards_Tweets.txt", ncolumns = 1)

#loaded the positive and negative.txt from Hu and Liu
positive <- scan("/users/yifeili/desktop/positive_words.txt", what = character(), comment.char = ";")
negative <- scan("/users/yifeili/desktop/negative_words.txt", what = character(), comment.char = ";")

#perform basic data cleaning
scoredsentiment <- function(hoc.vec, pos.word, neg.word)
{
            clean <- gsub("[[:punct:]]", " ", hoc.vec)
            clean <- gsub("[^[:graph:]]", "", clean)
            clean <- gsub("[[:cntrl:]]", "", clean)
            clean <- gsub("\\d+", "", clean) 
            clean <- tolower(clean)
            
            hoc.lst <- strsplit(clean, "") 
            scoredpositive <- sapply(hoc.lst, function(x) sum(!is.na(match(x, positive))))  
            scorednegative <- sapply(hoc.lst, function(x) sum(!is.na(match(x, negative))))
            hoc.df <- data.frame(score = scoredpositive - scorednegative, message = hoc.vec, stringsAsFactors = F)
            return (hoc.df)
}

twitter_scores <- scoredsentiment(netflix.text, positive, negative)
head(twitter_scores,10)

write.csv(twitter_scores, file=paste('_scores.csv'), row.names=TRUE)

#Sentimental Analysis with Datumbox API
library(ThinkToStartR)
library(twitteR)
library(plyr)
library(twitteR)
library(RCurl)
library(wordcloud)

#set up twitter APIs
consumer_key <- "yGfMZdr02SidVYVTiul5YdJIh"
consumer_secret <- "ZxTcNmfJQ2cxLlykvYbZFFn0upknNVkpmdxAiGRDCZwIFN8wkH"
token <- "3192371979-CPwxqkws80IXLReSe1yMYl9QWEzCSEIv37lnPlZ" 
token_secret <- "ZFeXPlFmA8hsDs6dCAeR4E909lIkfcSjUFGLQ3jGlmwo4" #Access token secret
setup_twitter_oauth(consumer_key, consumer_secret, token, token_secret)

ThinkToStart("setup_twitter_oauth",api_key="yGfMZdr02SidVYVTiul5YdJIh",api_secret="ZxTcNmfJQ2cxLlykvYbZFFn0upknNVkpmdxAiGRDCZwIFN8wkH")

ThinkToStart("SentimentCloud","House of Cards S1",30,"2c2aab873c34498ba6624bfdf0cf2faf")
